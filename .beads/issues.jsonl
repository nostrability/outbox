{"id":"outbox-5d4","title":"Review outbox bootstrapping and fallback strategies","description":"Analyze bootstrapping and fallback strategies for outbox:\n\n**Bootstrapping question (arkin0x):** What 'outbox bootstrapping relays' do implementations use?\n\n**Fallback strategies:**\n- Gossip: Falls back to user's configured read relays (e.g. damus relay) if no kind 10002\n- Amethyst: If user has no outbox list, defaults to all hints seen for that user\n- General: purplepag.es as relay discovery service\n\n**Aggregating relay model (mikedilger):**\n- Like RSS feed aggregators - single relay aggregates content from all followed users\n- Client connects to one relay for reads instead of fanning out\n- Desktop (Gossip): does fan-out at client because desktop = wall power + unmetered internet\n- Mobile: should use aggregating relay (user-configurable)\n- Examples: indexer.coracle.social, Primal's indexer approach\n\n**Replicatr (staab):**\n- Daemon listening to indexer for kind 10002 changes\n- Uses negentropy to sync user events to new relays\n- One deployed instance covers anyone whose metadata reaches indexer.coracle.social\n\n**Key questions to explore:**\n- What's the minimum viable bootstrapping relay set?\n- How do new users discover the right relays?\n- What's the role of purplepag.es and similar services?\n- Can relay discovery be made more automatic?\n\nRef: https://github.com/nostrability/nostrability/issues/69","status":"open","priority":3,"issue_type":"task","created_at":"2026-02-19T13:54:16.372063-06:00","created_by":"e","updated_at":"2026-02-19T13:54:16.372063-06:00","dependencies":[{"issue_id":"outbox-5d4","depends_on_id":"outbox-65k","type":"blocks","created_at":"2026-02-19T13:54:47.569032-06:00","created_by":"daemon"}]}
{"id":"outbox-65k","title":"Outbox Model Analysis (nostrability#69)","description":"Comprehensive review and analysis of outbox/inbox approaches across Nostr clients and libraries, based on https://github.com/nostrability/nostrability/issues/69. Covers implementation approaches, relay selection algorithms, tradeoffs, scalability concerns, and current status across the ecosystem.","status":"open","priority":1,"issue_type":"epic","created_at":"2026-02-19T13:53:16.540837-06:00","created_by":"e","updated_at":"2026-02-19T13:53:16.540837-06:00"}
{"id":"outbox-68e","title":"Document known challenges and tradeoffs","description":"Catalog challenges and tradeoffs identified by devs in nostrability#69:\n\n**Scalability:**\n- Large follow lists (\u003e300) cause problems (vitorpamplona) - relays reject large filters, too many connections\n- Browser websocket connection limits (typically ~256) constrain web clients\n- vitorpamplona: Tor/SOCKS proxy as multiplexer significantly speeds up connections to 1000s of relays\n- mikedilger: browsers aren't designed for this; suggests server-side fan-out or aggregating relay\n\n**Defunct/malicious relays:**\n- Many relays in kind 10002 lists are defunct (staab, cesardeazevedo)\n- Stale relay selections waste connections\n- Need health tracking and scoring\n- Rate limiting debate: mikedilger says disconnect on garbage (don't rate limit), fiatjaf/pablof7z agree\n- jb55: local relay model (nostrdb) as alternative - works offline too\n\n**Relay selection changes:**\n- No client currently handles relay migration properly (staab)\n- Need: sanity checks on new relays, event copying on migration, soft delete on old relays\n- Replicatr daemon (staab): listens for kind 10002 changes, syncs events to new relays via negentropy\n\n**User confusion:**\n- Posting to specific relay may also broadcast to inbox relays of tagged users (cesardeazevedo, vitorpamplona)\n- Need clear UI showing where notes actually get sent\n- NIP-70 (protected events) interaction with outbox\n- Users putting wrong relays in 10002 lists (vitorpamplona warning)\n\n**Contact vs Follow distinction:**\n- vitorpamplona: people 'follow' to mark trust (met at conference), not for content\n- Need separate concept for WoT contacts vs content follows\n\n**Centralization pressure:**\n- Popular relay algorithms centralize traffic (vitorpamplona)\n- Complex filters abuse popular relay CPUs\n- Personal relays as decentralization goal, but makes algorithm irrelevant\n\n**Relay hints:**\n- pablof7z: relay hints tie decentralized nostr together\n- sondreb: pubkey on root 'e' tag needed for outbox to work on replies\n\nRef: https://github.com/nostrability/nostrability/issues/69","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-19T13:53:55.061706-06:00","created_by":"e","updated_at":"2026-02-19T13:53:55.061706-06:00","dependencies":[{"issue_id":"outbox-68e","depends_on_id":"outbox-65k","type":"blocks","created_at":"2026-02-19T13:54:47.501632-06:00","created_by":"daemon"}]}
{"id":"outbox-6r6","title":"Analyze relay selection \u0026 scoring algorithms","description":"Deep dive into relay selection strategies discussed in nostrability#69:\n\n**Gossip model (mikedilger):**\n- SQLite person_relay table with scoring\n- Sources ranked: kind 10002 \u003e kind 3 contents \u003e nip05 \u003e relay hints\n- Tracks last_fetched timestamp per relay per person\n- Selects 2-3 relays per person (configurable) to minimize connections\n- Fallback: user's configured read relays\n\n**Coracle model (staab):**\n- Max connections per request setting\n- Long-tail pubkeys redistributed to top ~10 relays\n- Tracks relay health: defunct relays, failed connections, auth denials\n- Considers relay quality signals beyond just 10002\n- Full code: welshman Router.ts\n\n**nostr-sdk/go (fiatjaf):**\n- Scoring order: kind 10002 listing \u003e successful event fetch (weighted by recency) \u003e nip05/nip19/relay hints\n- Currently in-memory only\n\n**Applesauce (hzrd149):**\n- Greedy set-cover algorithm\n- Priority: minimize total connections\n- Steps: calculate relay popularity → limit each user to 2 most popular relays → select next relay by coverage → repeat until max connections or full coverage\n- Result: ~30 connections for 311 pubkeys\n\n**Voyage (dluvian):**\n- 2 relays per pubkey: 1 from kind 10002 + 1 most-used event relay\n\n**Cloudfodder's greedy set cover analysis:**\n- 3 relays cover ~85% of follows\n- 10 relays cover ~93%\n- Long tail of personal relays hard to cover\n\n**Wisp (barrydeen):**\n- RelayScoreBoard Kotlin implementation\n\nRef: https://github.com/nostrability/nostrability/issues/69","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-19T13:53:40.07295-06:00","created_by":"e","updated_at":"2026-02-19T13:53:40.07295-06:00","dependencies":[{"issue_id":"outbox-6r6","depends_on_id":"outbox-65k","type":"blocks","created_at":"2026-02-19T13:54:47.465775-06:00","created_by":"daemon"}]}
{"id":"outbox-b6c","title":"Analyze outbox as relay selection heuristic (staab framework)","description":"Analyze staab's framework from his book chapter on outbox as one of many relay selection heuristics:\n\n**Core insight:** Outbox is NOT the whole routing solution - it's one heuristic among many.\n\n**Heuristics taxonomy:**\n1. **Outbox (NIP 65 write relays):** For author-based retrieval of public content. User publishes kind 10002 declaring where their public content lives.\n2. **Inbox (NIP 65 read relays):** For @-mention discovery. Post to mentioned users' inbox relays.\n3. **NIP 17 DM inbox (kind 10050):** Separate relay list for encrypted DMs.\n4. **NIP 72 community relays:** Events posted to community-defined relay tags.\n5. **NIP 29 group relays:** Access-controlled, should NOT leak to outbox.\n6. **NIP 47 zap receipts:** Should go to zap request author's outbox, not receipt author's.\n7. **Ad-hoc relay heuristics:** Relay's own content curation policy.\n8. **User-defined:** Manual relay selection by users.\n\n**Key principles:**\n- Heuristics are additive (like database indexes) - apply all relevant ones\n- Exception: access control (NIP 29 groups) - intentionally limit heuristics\n- NIPs that don't define relay selection heuristics are inherently flawed\n- No implementation will have complete view of all applicable heuristics\n- Apps only need heuristics relevant to their supported use cases\n\n**Unsolved problems:**\n- Events with t-tags (topics) or g-tags (geocache) have no standard heuristic\n- Currently solved by manual relay selection → centralization or missed notes\n- Need: relay signaling of supported kinds/tags (NIP 66, nip11)\n\nRef: https://github.com/nostrability/nostrability/issues/69, staab book chapter","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-19T13:54:07.220645-06:00","created_by":"e","updated_at":"2026-02-19T13:54:07.220645-06:00","dependencies":[{"issue_id":"outbox-b6c","depends_on_id":"outbox-65k","type":"blocks","created_at":"2026-02-19T13:54:47.536279-06:00","created_by":"daemon"}]}
{"id":"outbox-ov0","title":"Document implementation approaches across clients/libraries","description":"Map out how each client/library implements outbox:\n\n**Clients with outbox:**\n- Amethyst (vitorpamplona): Full outbox PR #1388, person_relay tracking, Tor multiplexing insight, ~300 follow limit discovered\n- Coracle (staab): Complex relay selection with scoring, max connections per request, long-tail redistribution to top relays. Code: welshman/packages/util/src/Router.ts\n- Nostur (fabianfabian): Outbox+inbox, limited to follows and relay hints\n- Gossip (mikedilger): person_relay SQLite table, scoring by kind 10002/kind 3/nip05, fallback to user read relays, limits to 2-3 relays per person\n- Voyage (dluvian): kind 10002 + event relay tracking, max 2 relays per pubkey\n- Nosotros (cesardeazevedo): person_relay table (kind 10002, kind 3, nip05), relays as observables, 4 read-only relays per user, lazy relay discovery\n- Yakihonne: Confirmed outbox on iOS\n- Shopstr: Confirmed support\n- Wisp (barrydeen): RelayScoreBoard approach\n- Notedeck: Foundation PR in progress (#1288)\n\n**Libraries with outbox:**\n- NDK (pablof7z): Outbox was the reason NDK was created. All NDK apps get outbox.\n- rust-nostr (yukibtc): Basic outbox in v0.35, persistent storage planned for v0.36\n- nostr-sdk/go (fiatjaf): In-memory relay scoring similar to Gossip\n- Dart NDK (frnandu): Gossip support, used by Yana and Camelus\n- Applesauce (hzrd149): Greedy relay selection algo, ~30 connections for 311 pubkeys\n\n**Not yet / planned:**\n- Damus iOS: Experimental PR #3291, not yet reviewed\n- Primal: Uses indexer approach instead\n\nRef: https://github.com/nostrability/nostrability/issues/69","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-19T13:53:30.362057-06:00","created_by":"e","updated_at":"2026-02-19T13:53:30.362057-06:00","dependencies":[{"issue_id":"outbox-ov0","depends_on_id":"outbox-65k","type":"blocks","created_at":"2026-02-19T13:54:47.430695-06:00","created_by":"daemon"}]}
{"id":"outbox-s3q","title":"Assess outbox effectiveness measurement approaches","description":"Explore whether/how outbox effectiveness can be measured:\n\n**alltheseas question:** Is it technically possible to measure effectiveness of various outbox implementations, as measured by notes not found?\n\n**staab answer:** Yes, but very complex, would require a driver for each implementation.\n\n**alltheseas follow-up questions:**\n- In what conditions does the algo fail to find an event?\n- Is there an auto-reporting error/failure log feature?\n- Has anyone measured and compared success/failure rates?\n\n**Cloudfodder's analysis approach:**\n- Greedy set cover algorithm on NIP-65 relay lists of follows\n- Results: 3 relays = ~85%, 10 relays = ~93%, 20 relays = ~95% coverage\n- 38/726 follows uncovered even with 20 relays\n\n**vitorpamplona battery test:**\n- 100% to 80% battery in 1hr active screen time with 400 relays\n- Practical measure of resource cost\n\n**Potential metrics:**\n- Event coverage (% of followed users' events found)\n- Connection count needed\n- Battery/bandwidth cost\n- Latency to first event\n- Staleness of relay list data\n\nRef: https://github.com/nostrability/nostrability/issues/69","status":"open","priority":3,"issue_type":"task","created_at":"2026-02-19T13:54:24.547992-06:00","created_by":"e","updated_at":"2026-02-19T13:54:24.547992-06:00","dependencies":[{"issue_id":"outbox-s3q","depends_on_id":"outbox-65k","type":"blocks","created_at":"2026-02-19T13:54:47.600191-06:00","created_by":"daemon"}]}
